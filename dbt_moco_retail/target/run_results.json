{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.9", "generated_at": "2025-08-27T19:31:09.485200Z", "invocation_id": "a4082cf5-6024-4e44-8b28-75a69b640f6c", "invocation_started_at": "2025-08-27T19:31:08.105505Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.014559Z", "completed_at": "2025-08-27T19:31:09.021503Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.022505Z", "completed_at": "2025-08-27T19:31:09.087591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07603168487548828, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.stg_moco_retail", "compiled": true, "compiled_code": "\nselect * from \"moco_retail\".\"main\".\"raw_moco_retail\"", "relation_name": "\"moco_retail\".\"main\".\"stg_moco_retail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.018988Z", "completed_at": "2025-08-27T19:31:09.040358Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.040358Z", "completed_at": "2025-08-27T19:31:09.089579Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08852696418762207, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.stg_moco_retail_typed", "compiled": true, "compiled_code": "\n\nwith src as (\n  select * from \"moco_retail\".\"main\".\"raw_moco_retail\"\n),\nrenamed as (\n  select try_cast(\"YEAR\" as integer) as year_num,\n         try_cast(\"MONTH\" as integer) as month_num,\n         cast(\"SUPPLIER\" as varchar) as supplier,\n         cast(\"ITEM CODE\" as varchar) as item_code,\n         cast(\"ITEM DESCRIPTION\" as varchar) as item_description,\n         cast(\"ITEM TYPE\" as varchar) as item_type,\n         try_cast(\"RETAIL SALES\" as double)  as retail_sales,\n         try_cast(\"RETAIL TRANSFERS\" as double)  as retail_transfers,\n         try_cast(\"WAREHOUSE SALES\" as double)  as warehouse_sales\n    from src\n),\nfinal as (\n  select year_num, month_num, supplier,\n         item_code, item_description, item_type,\n         retail_sales, retail_transfers, warehouse_sales,\n         case\n           when year_num between 1900 and 2100 and month_num between 1 and 12\n           then make_date(year_num, month_num, 1)\n           else null\n         end as sale_date\n    from renamed\n)\nselect * from final", "relation_name": "\"moco_retail\".\"main\".\"stg_moco_retail_typed\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.106615Z", "completed_at": "2025-08-27T19:31:09.120415Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.120415Z", "completed_at": "2025-08-27T19:31:09.157355Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.055734872817993164, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.accepted_values_stg_moco_retail_typed_month_num__1__2__3__4__5__6__7__8__9__10__11__12.f7c2e26a40", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        month_num as value_field,\n        count(*) as n_records\n\n    from \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\n    group by month_num\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','3','4','5','6','7','8','9','10','11','12'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.114518Z", "completed_at": "2025-08-27T19:31:09.130677Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.130677Z", "completed_at": "2025-08-27T19:31:09.157355Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05574941635131836, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.not_null_stg_moco_retail_typed_sale_date.36b44cd906", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\nwhere sale_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.165693Z", "completed_at": "2025-08-27T19:31:09.171065Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.172069Z", "completed_at": "2025-08-27T19:31:09.288571Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1262068748474121, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.dim_item", "compiled": true, "compiled_code": "\n\nwith base as (\n  select\n    item_code,\n    item_description,\n    item_type,\n    coalesce(nullif(trim(supplier), ''), 'unknown') as supplier\n  from \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\n),\ndim as (\n  select\n    item_code,\n    max(item_description) as item_description,\n    max(item_type)        as item_type,\n    max(supplier)         as supplier\n  from base\n  group by item_code\n)\nselect * from dim", "relation_name": "\"moco_retail\".\"main\".\"dim_item\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.167932Z", "completed_at": "2025-08-27T19:31:09.182400Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.182400Z", "completed_at": "2025-08-27T19:31:09.305450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23564815521240234, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.fct_monthly_sales", "compiled": true, "compiled_code": "\n\nwith base as (\n  select *\n  from \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\n  where sale_date is not null\n  \n    and sale_date >= (select coalesce(max(sale_date), '1900-01-01') from \"moco_retail\".\"main\".\"fct_monthly_sales\")\n  \n),\nnorm as (\n  select\n    sale_date,\n    coalesce(nullif(trim(supplier), ''), 'unknown') as supplier,\n    item_code,\n    item_description,\n    item_type,\n    coalesce(retail_sales,0)      as retail_sales,\n    coalesce(retail_transfers,0)  as retail_transfers,\n    coalesce(warehouse_sales,0)   as warehouse_sales\n  from base\n),\nagg as (\n  select\n    sale_date,\n    supplier,\n    item_code,\n    item_description,\n    item_type,\n    sum(retail_sales)                                as retail_sales,\n    sum(retail_transfers)                            as retail_transfers,\n    sum(warehouse_sales)                             as warehouse_sales,\n    sum(retail_sales + retail_transfers + warehouse_sales) as total_sales\n  from norm\n  group by 1,2,3,4,5\n)\nselect * from agg", "relation_name": "\"moco_retail\".\"main\".\"fct_monthly_sales\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.410333Z", "completed_at": "2025-08-27T19:31:09.418323Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.420527Z", "completed_at": "2025-08-27T19:31:09.447432Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.047901153564453125, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.not_null_fct_monthly_sales_sale_date.8e81663a4c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom \"moco_retail\".\"main\".\"fct_monthly_sales\"\nwhere sale_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.407835Z", "completed_at": "2025-08-27T19:31:09.417995Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.418985Z", "completed_at": "2025-08-27T19:31:09.449432Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.047901153564453125, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.not_null_fct_monthly_sales_item_code.2e90d8621a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_code\nfrom \"moco_retail\".\"main\".\"fct_monthly_sales\"\nwhere item_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.412338Z", "completed_at": "2025-08-27T19:31:09.418673Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.422270Z", "completed_at": "2025-08-27T19:31:09.450436Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.047901153564453125, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.not_null_fct_monthly_sales_supplier.4b3f574c89", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier\nfrom \"moco_retail\".\"main\".\"fct_monthly_sales\"\nwhere supplier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T19:31:09.415349Z", "completed_at": "2025-08-27T19:31:09.420527Z"}, {"name": "execute", "started_at": "2025-08-27T19:31:09.422270Z", "completed_at": "2025-08-27T19:31:09.468641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06405210494995117, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.unique_combo_fct_monthly_sales_sale_date__item_code__supplier.c44c4b5c5d", "compiled": true, "compiled_code": "\nselect\n    sale_date, item_code, supplier,\n    count(*) as count\nfrom \"moco_retail\".\"main\".\"fct_monthly_sales\"\ngroup by sale_date, item_code, supplier\nhaving count(*) > 1\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.5867433547973633, "args": {"vars": {}, "state_modified_compare_more_unrendered_values": false, "log_format_file": "debug", "use_fast_test_edges": false, "require_all_warnings_handled_by_warn_error": false, "which": "build", "populate_cache": true, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": true, "log_level_file": "debug", "validate_macro_args": false, "indirect_selection": "eager", "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "version_check": true, "quiet": false, "cache_selected_only": false, "project_dir": "dbt_moco_retail", "show_all_deprecations": false, "require_generic_test_arguments_property": true, "invocation_command": "dbt build --project-dir dbt_moco_retail --profiles-dir C:\\Project_CV\\Projects\\Full_ETL_To_BI\\moco-retail-sales-pipeline\\.dbt", "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "printer_width": 80, "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "log_level": "info", "defer": false, "log_format": "default", "partial_parse_file_diff": true, "select": [], "include_saved_query": false, "exclude_resource_types": [], "exclude": [], "log_path": "dbt_moco_retail\\logs", "empty": false, "export_saved_queries": false, "skip_nodes_if_on_run_start_fails": false, "require_resource_names_without_spaces": true, "show_resource_report": false, "profiles_dir": "C:\\Project_CV\\Projects\\Full_ETL_To_BI\\moco-retail-sales-pipeline\\.dbt", "resource_types": [], "introspect": true, "use_colors_file": true, "static_parser": true, "favor_state": false, "partial_parse": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "macro_debugging": false, "upload_to_artifacts_ingest_api": false, "use_colors": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "show": false}}