{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.9", "generated_at": "2025-08-27T15:42:42.302081Z", "invocation_id": "9b20a317-d666-4920-a878-5bc0b2ea0aa1", "invocation_started_at": "2025-08-27T15:42:41.010731Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T15:42:41.730347Z", "completed_at": "2025-08-27T15:42:41.738149Z"}, {"name": "execute", "started_at": "2025-08-27T15:42:41.738149Z", "completed_at": "2025-08-27T15:42:41.803417Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07562899589538574, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.stg_moco_retail", "compiled": true, "compiled_code": "\nselect * from \"moco_retail\".\"main\".\"raw_moco_retail\"", "relation_name": "\"moco_retail\".\"main\".\"stg_moco_retail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T15:42:41.735673Z", "completed_at": "2025-08-27T15:42:41.738149Z"}, {"name": "execute", "started_at": "2025-08-27T15:42:41.757632Z", "completed_at": "2025-08-27T15:42:41.807868Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08722853660583496, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.stg_moco_retail_typed", "compiled": true, "compiled_code": "\n\nwith src as (\n  select * from \"moco_retail\".\"main\".\"raw_moco_retail\"\n),\nrenamed as (\n  select\n    try_cast(\"YEAR\"               as integer) as year_num,\n    try_cast(\"MONTH\"              as integer) as month_num,\n    cast     (\"SUPPLIER\"          as varchar) as supplier,\n    cast     (\"ITEM CODE\"         as varchar) as item_code,\n    cast     (\"ITEM DESCRIPTION\"  as varchar) as item_description,\n    cast     (\"ITEM TYPE\"         as varchar) as item_type,\n    try_cast (\"RETAIL SALES\"      as double)  as retail_sales,\n    try_cast (\"RETAIL TRANSFERS\"  as double)  as retail_transfers,\n    try_cast (\"WAREHOUSE SALES\"   as double)  as warehouse_sales\n  from src\n),\nfinal as (\n  select\n    year_num,\n    month_num,\n    supplier,\n    item_code,\n    item_description,\n    item_type,\n    retail_sales,\n    retail_transfers,\n    warehouse_sales,\n    case\n      when year_num between 1900 and 2100 and month_num between 1 and 12\n      then make_date(year_num, month_num, 1)\n      else null\n    end as sale_date\n  from renamed\n)\nselect * from final", "relation_name": "\"moco_retail\".\"main\".\"stg_moco_retail_typed\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T15:42:41.822729Z", "completed_at": "2025-08-27T15:42:41.834028Z"}, {"name": "execute", "started_at": "2025-08-27T15:42:41.834028Z", "completed_at": "2025-08-27T15:42:41.865429Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04721546173095703, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.not_null_stg_moco_retail_typed_item_code.3b5150392a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_code\nfrom \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\nwhere item_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-27T15:42:41.830881Z", "completed_at": "2025-08-27T15:42:41.843257Z"}, {"name": "execute", "started_at": "2025-08-27T15:42:41.843257Z", "completed_at": "2025-08-27T15:42:41.867943Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04895806312561035, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.moco_retail.not_null_stg_moco_retail_typed_sale_date.36b44cd906", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\nwhere sale_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T15:42:41.875701Z", "completed_at": "2025-08-27T15:42:41.879208Z"}, {"name": "execute", "started_at": "2025-08-27T15:42:41.880212Z", "completed_at": "2025-08-27T15:42:41.957945Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08725953102111816, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.dim_item", "compiled": true, "compiled_code": "\n\nwith base as (\n  select\n    item_code,\n    item_description,\n    item_type,\n    supplier\n  from \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\n),\ndim as (\n  -- Use MAX on text (stable + DuckDB-friendly) to get a representative value\n  select\n    item_code,\n    max(item_description) as item_description,\n    max(item_type)        as item_type,\n    max(supplier)         as supplier\n  from base\n  group by item_code\n)\nselect * from dim", "relation_name": "\"moco_retail\".\"main\".\"dim_item\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-27T15:42:41.877701Z", "completed_at": "2025-08-27T15:42:41.880212Z"}, {"name": "execute", "started_at": "2025-08-27T15:42:41.890435Z", "completed_at": "2025-08-27T15:42:42.237540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.40305662155151367, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.moco_retail.fct_monthly_sales", "compiled": true, "compiled_code": "\n\nwith base as (\n  select *\n  from \"moco_retail\".\"main\".\"stg_moco_retail_typed\"\n  where sale_date is not null\n),\nnorm as (\n  select\n    sale_date,\n    supplier,\n    item_code,\n    item_description,\n    item_type,\n    coalesce(retail_sales, 0)      as retail_sales,\n    coalesce(retail_transfers, 0)  as retail_transfers,\n    coalesce(warehouse_sales, 0)   as warehouse_sales\n  from base\n),\nagg as (\n  select\n    sale_date,\n    supplier,\n    item_code,\n    item_description,\n    item_type,\n    sum(retail_sales)                    as retail_sales,\n    sum(retail_transfers)                as retail_transfers,\n    sum(warehouse_sales)                 as warehouse_sales,\n    sum(retail_sales + retail_transfers + warehouse_sales) as total_sales\n  from norm\n  group by 1,2,3,4,5\n)\nselect * from agg", "relation_name": "\"moco_retail\".\"main\".\"fct_monthly_sales\"", "batch_results": null}], "elapsed_time": 0.7430789470672607, "args": {"show_resource_report": false, "log_file_max_bytes": 10485760, "select": [], "favor_state": false, "profiles_dir": "C:\\Project_CV\\Projects\\Full_ETL_To_BI\\moco-retail-sales-pipeline\\.dbt", "indirect_selection": "eager", "require_explicit_package_overrides_for_builtin_materializations": true, "resource_types": [], "log_format_file": "debug", "populate_cache": true, "empty": false, "print": true, "static_parser": true, "strict_mode": false, "require_all_warnings_handled_by_warn_error": false, "require_resource_names_without_spaces": true, "log_format": "default", "show_all_deprecations": false, "exclude_resource_types": [], "which": "build", "partial_parse_file_diff": true, "require_generic_test_arguments_property": true, "use_colors_file": true, "export_saved_queries": false, "include_saved_query": false, "project_dir": "dbt_moco_retail", "require_yaml_configuration_for_mf_time_spines": false, "use_colors": true, "defer": false, "use_fast_test_edges": false, "macro_debugging": false, "upload_to_artifacts_ingest_api": false, "introspect": true, "vars": {}, "version_check": true, "validate_macro_args": false, "partial_parse": true, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "show": false, "source_freshness_run_project_hooks": true, "quiet": false, "state_modified_compare_more_unrendered_values": false, "require_batched_execution_for_custom_microbatch_strategy": false, "invocation_command": "dbt build --project-dir dbt_moco_retail --profiles-dir C:\\Project_CV\\Projects\\Full_ETL_To_BI\\moco-retail-sales-pipeline\\.dbt", "write_json": true, "exclude": [], "log_path": "dbt_moco_retail\\logs", "send_anonymous_usage_stats": true, "state_modified_compare_vars": false, "log_level_file": "debug", "printer_width": 80, "require_nested_cumulative_type_params": false, "cache_selected_only": false, "warn_error_options": {"error": [], "warn": [], "silence": []}}}